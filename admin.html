<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Admin</title><style>body{font-family:system-ui;margin:0;background:#f6f7fb}header{padding:12px;background:#fff;display:flex;gap:8px;align-items:center;border-bottom:1px solid #eee}.logo{font-weight:800;color:red}.wrap{max-width:1000px;margin:20px auto;padding:16px}.card{background:#fff;padding:12px;border-radius:8px;border:1px solid #eee;margin-bottom:12px}input,button,textarea{padding:8px;border-radius:8px;border:1px solid #ddd}button{background:#111;color:#fff}</style></head><body><header><div class="logo">MBL</div><div style="color:#777">MobileBanking.legit</div></header><div class="wrap" id="loginWrap"><div class="card"><h3>Admin Login</h3><input id="aemail" placeholder="Admin email"><input id="apass" placeholder="Password" type="password"><button onclick="adminLogin()">Login</button></div></div><div class="wrap" id="panel" style="display:none"><div class="card"><h3>Admin Panel</h3><button onclick="adminLogout()">Logout</button></div><div class="card"><h3>Users</h3><div id="users"></div></div><div class="card"><h3>Transactions</h3><div id="tx"></div></div><div class="card"><h3>Update Admin Account</h3><input id="newEmail" placeholder="New email"><input id="newPass" placeholder="New password"><button onclick="updateAdmin()">Update</button></div><div class="card"><h3>Live Chat Script</h3><textarea id="chatScript" rows="6" style="width:100%"></textarea><button onclick="saveChat()">Save</button></div></div><script>function qs(id){return document.getElementById(id)}function adminLogin(){fetch('/admin/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:qs('aemail').value,password:qs('apass').value})}).then(r=>r.json()).then(x=>{ if(x.success){qs('loginWrap').style.display='none';qs('panel').style.display='block';loadUsers();loadTx();loadChat()} else alert(x.error)})}function adminLogout(){fetch('/admin/logout',{method:'POST'}).then(()=>location.reload())}function loadUsers(){fetch('/admin/users').then(r=>r.json()).then(rows=>{qs('users').innerHTML = rows.map(u=>`<div>${u.id} - ${u.email} - $${(u.balance_cents/100).toFixed(2)} <input id="set${u.id}" placeholder="amount"><button onclick="setBal(${u.id})">Set</button><input id="add${u.id}" placeholder="amt"><button onclick="addBal(${u.id})">Add</button></div>`).join('')})}function setBal(id){fetch('/admin/users/'+id+'/balance',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({mode:'set',amount:qs('set'+id).value})}).then(()=>loadUsers())}function addBal(id){fetch('/admin/users/'+id+'/balance',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({mode:'add',amount:qs('add'+id).value})}).then(()=>loadUsers())}function loadTx(){fetch('/admin/transactions').then(r=>r.json()).then(rows=>qs('tx').innerHTML = rows.map(t=>`<div>${t.id} | user ${t.user_id} | $${(t.amount_cents/100).toFixed(2)} | ${t.status} <select id="st${t.id}"><option>Approved</option><option>Failed</option><option>Reversed</option></select><button onclick="setStatus(${t.id})">Set</button></div>`).join(''))}function setStatus(id){fetch('/admin/transactions/'+id+'/status',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({status:qs('st'+id).value})}).then(()=>loadTx())}function updateAdmin(){fetch('/admin/account',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:qs('newEmail').value,password:qs('newPass').value})}).then(r=>r.json()).then(x=>alert('Updated'))}function loadChat(){fetch('/settings/live-chat').then(r=>r.json()).then(d=>qs('chatScript').value = d.script||'')}function saveChat(){fetch('/settings/live-chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({script:qs('chatScript').value})}).then(()=>alert('Saved'))}fetch('/settings/live-chat').then(r=>r.json()).then(d=>{ if(d.script) document.getElementById('live-chat-placeholder').innerHTML = d.script });</script></body></html>
